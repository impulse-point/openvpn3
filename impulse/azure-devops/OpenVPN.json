{"options":[{"enabled":false,"definition":{"id":"5d58cc01-7c75-450c-be18-a388ddb129ec"},"inputs":{"branchFilters":"[\"+refs/heads/*\"]","additionalFields":"{}"}},{"enabled":false,"definition":{"id":"a9db38f9-9fdc-478c-b0f9-464221e58316"},"inputs":{"workItemType":"1352894","assignToRequestor":"true","additionalFields":"{}"}}],"triggers":[{"branchFilters":["+master"],"pathFilters":[],"batchChanges":false,"maxConcurrentBuildsPerBranch":1,"pollingInterval":180,"pollingJobId":"519e6496-18b8-4da2-8ef9-8176f4338f6f","triggerType":2}],"variables":{"system.debug":{"value":"false","allowOverride":true}},"retentionRules":[{"branches":["+refs/heads/*"],"artifacts":[],"artifactTypesToDelete":["FilePath","SymbolStore"],"daysToKeep":10,"minimumToKeep":1,"deleteBuildRecord":true,"deleteTestResults":true}],"properties":{},"tags":[],"_links":{"self":{"href":"https://impulse-point.visualstudio.com/6e18cf95-575d-4867-9f79-45c08f8a903a/_apis/build/Definitions/11?revision=72"},"web":{"href":"https://impulse-point.visualstudio.com/6e18cf95-575d-4867-9f79-45c08f8a903a/_build/definition?definitionId=11"},"editor":{"href":"https://impulse-point.visualstudio.com/6e18cf95-575d-4867-9f79-45c08f8a903a/_build/designer?id=11&_a=edit-build-definition"},"badge":{"href":"https://impulse-point.visualstudio.com/6e18cf95-575d-4867-9f79-45c08f8a903a/_apis/build/status/11"}},"jobAuthorizationScope":1,"jobTimeoutInMinutes":60,"jobCancelTimeoutInMinutes":5,"process":{"phases":[{"steps":[{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Download vswhere","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"1.*","definitionType":"task"},"inputs":{"filename":"curl","arguments":"http://downloads.impulse.com/vsts/windows/vswhere.zip --output vswhere.zip","workingFolder":"$(System.DefaultWorkingDirectory)/tools-zipped","failOnStandardError":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Download patch","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"1.*","definitionType":"task"},"inputs":{"filename":"curl","arguments":"http://downloads.impulse.com/vsts/windows/patch-2.5.9-7-bin.zip --output patch-2.5.9-7-bin.zip","workingFolder":"$(System.DefaultWorkingDirectory)/tools-zipped","failOnStandardError":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Download swig","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"1.*","definitionType":"task"},"inputs":{"filename":"curl","arguments":"http://downloads.impulse.com/vsts/windows/swigwin-3.0.12.zip --output swigwin-3.0.12.zip","workingFolder":"$(System.DefaultWorkingDirectory)/tools-zipped","failOnStandardError":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Unzip tools","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"5e1e3830-fbfb-11e5-aab1-090c92bc4988","versionSpec":"1.*","definitionType":"task"},"inputs":{"archiveFilePatterns":"$(System.DefaultWorkingDirectory)/tools-zipped/*.zip","destinationFolder":"$(System.DefaultWorkingDirectory)/tools","cleanDestinationFolder":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Generate swig sources","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"1.*","definitionType":"task"},"inputs":{"filename":"$(System.DefaultWorkingDirectory)\\tools\\swigwin-3.0.12\\swig.exe","arguments":"-c++ -csharp -I..\\ovpn3\\core\\client -I..\\ovpn3\\core -outcurrentdir ..\\ovpn3\\core\\javacli\\ovpncli.i","workingFolder":".swig","failOnStandardError":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Archive dependencies/lz4-master","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"d8b84976-e99a-4b86-b885-4849694435b0","versionSpec":"2.*","definitionType":"task"},"inputs":{"rootFolderOrFile":"dependencies/lz4-master","includeRootFolder":"true","archiveType":"zip","tarCompression":"gz","archiveFile":"dependencies/lz4-master.zip","replaceExistingArchive":"true","verbose":"false","quiet":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Archive dependencies/mbedtls-master","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"d8b84976-e99a-4b86-b885-4849694435b0","versionSpec":"2.*","definitionType":"task"},"inputs":{"rootFolderOrFile":"dependencies/mbedtls-master","includeRootFolder":"true","archiveType":"zip","tarCompression":"gz","archiveFile":"dependencies/mbedtls-master.zip","replaceExistingArchive":"true","verbose":"false","quiet":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Archive dependencies/asio-master","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"d8b84976-e99a-4b86-b885-4849694435b0","versionSpec":"2.*","definitionType":"task"},"inputs":{"rootFolderOrFile":"dependencies/asio-master","includeRootFolder":"true","archiveType":"zip","tarCompression":"gz","archiveFile":"dependencies/asio-master.zip","replaceExistingArchive":"true","verbose":"false","quiet":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Apply patch to utils.py","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"1.*","definitionType":"task"},"inputs":{"filename":"$(System.DefaultWorkingDirectory)\\tools\\bin\\patch.exe","arguments":"ovpn3/core/win/utils.py ovpn3/core/impulse/utils.py.patch","workingFolder":"","failOnStandardError":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Apply patch to openvpn/common/scoped_fd.hpp","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"1.*","definitionType":"task"},"inputs":{"filename":"$(System.DefaultWorkingDirectory)\\tools\\bin\\patch.exe","arguments":"ovpn3/core/openvpn/common/scoped_fd.hpp ovpn3/core/impulse/scoped_fd.hpp.patch","workingFolder":"","failOnStandardError":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Apply patch to openvpn/tun/builder/client.hpp","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"1.*","definitionType":"task"},"inputs":{"filename":"$(System.DefaultWorkingDirectory)\\tools\\bin\\patch.exe","arguments":"ovpn3/core/openvpn/tun/builder/client.hpp ovpn3/core/impulse/client.hpp.patch","workingFolder":"","failOnStandardError":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Apply patch to openvpn/tun/tunio.hpp","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"1.*","definitionType":"task"},"inputs":{"filename":"$(System.DefaultWorkingDirectory)\\tools\\bin\\patch.exe","arguments":"ovpn3/core/openvpn/tun/tunio.hpp ovpn3/core/impulse/tunio.hpp.patch","workingFolder":"","failOnStandardError":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Apply patch to openvpn/win/call.hpp","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"1.*","definitionType":"task"},"inputs":{"filename":"$(System.DefaultWorkingDirectory)\\tools\\bin\\patch.exe","arguments":"ovpn3/core/openvpn/win/call.hpp ovpn3/core/impulse/call.hpp.patch","workingFolder":"","failOnStandardError":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Generate mustache views","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"echo \"{\n    \\\"buildDir\\\": \\\"$(echo $SYSTEM_DEFAULTWORKINGDIRECTORY | sed 's/\\\\/\\\\\\\\\\\\\\\\/g')\\\",\n    \\\"arch\\\": \\\"x86\\\",\n    \\\"target\\\": \\\"bin\\\\\\\\\\\\\\\\x86\\\\\\\\\\\\\\\\ovpncli.dll\\\"\n}\" > $SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3/core/win/parms_local.py.view.x86\necho \"ovpn3/core/win/parms_local.py.view.x86\"\ncat $SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3/core/win/parms_local.py.view.x86\necho \"{\n    \\\"buildDir\\\": \\\"$(echo $SYSTEM_DEFAULTWORKINGDIRECTORY | sed 's/\\\\/\\\\\\\\\\\\\\\\/g')\\\",\n    \\\"arch\\\": \\\"amd64\\\",\n    \\\"target\\\": \\\"bin\\\\\\\\\\\\\\\\x64\\\\\\\\\\\\\\\\ovpncli.dll\\\"\n}\" > $SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3/core/win/parms_local.py.view.x64\necho \"ovpn3/core/win/parms_local.py.view.x64\"\ncat $SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3/core/win/parms_local.py.view.x64","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"npm install mustache","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"fe47e961-9fa8-4106-8639-368c022d43ad","versionSpec":"1.*","definitionType":"task"},"inputs":{"command":"custom","workingDir":"","verbose":"false","customCommand":"install mustache","customRegistry":"useNpmrc","customFeed":"","customEndpoint":"","publishRegistry":"useExternalRegistry","publishFeed":"","publishPackageMetadata":"true","publishEndpoint":""}},{"environment":{},"enabled":false,"continueOnError":false,"alwaysRun":false,"displayName":"Generate parms_local.py (x86)","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"1.*","definitionType":"task"},"inputs":{"filename":"$(Build.SourcesDirectory)\\node_modules\\.bin\\mustache","arguments":"parms_local.py.view.x86 ..\\impulse\\parms_local.py.mustache parms_local.py","workingFolder":"ovpn3/core/win","failOnStandardError":"false"}},{"environment":{},"enabled":false,"continueOnError":false,"alwaysRun":false,"displayName":"Build dependencies (x86)","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"1.*","definitionType":"task"},"inputs":{"filename":"C:\\Python27amd64\\python.exe","arguments":"buildep.py","workingFolder":"ovpn3/core/win","failOnStandardError":"false"}},{"environment":{},"enabled":false,"continueOnError":false,"alwaysRun":false,"displayName":"Make output directory (x86)","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"1.*","definitionType":"task"},"inputs":{"filename":"mkdir","arguments":"bin\\x86","workingFolder":"ovpn3/core/win","failOnStandardError":"false"}},{"environment":{},"enabled":false,"continueOnError":false,"alwaysRun":false,"displayName":"Build (x86)","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"1.*","definitionType":"task"},"inputs":{"filename":"C:\\Python27amd64\\python.exe","arguments":"build.py ..\\..\\..\\.swig\\ovpncli_wrap.cxx","workingFolder":"ovpn3/core/win","failOnStandardError":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Generate parms_local.py (x64)","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"1.*","definitionType":"task"},"inputs":{"filename":"$(Build.SourcesDirectory)\\node_modules\\.bin\\mustache","arguments":"parms_local.py.view.x64 ..\\impulse\\parms_local.py.mustache parms_local.py","workingFolder":"ovpn3/core/win","failOnStandardError":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Build dependencies (x64)","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"1.*","definitionType":"task"},"inputs":{"filename":"C:\\Python27amd64\\python.exe","arguments":"buildep.py","workingFolder":"ovpn3/core/win","failOnStandardError":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Make output directory (x64)","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"1.*","definitionType":"task"},"inputs":{"filename":"mkdir","arguments":"bin\\x64","workingFolder":"ovpn3/core/win","failOnStandardError":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Build (x64)","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"1.*","definitionType":"task"},"inputs":{"filename":"C:\\Python27amd64\\python.exe","arguments":"build.py ..\\..\\..\\.swig\\ovpncli_wrap.cxx","workingFolder":"ovpn3/core/win","failOnStandardError":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"dotnet restore","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"5541a522-603c-47ad-91fc-a4b1d163081b","versionSpec":"2.*","definitionType":"task"},"inputs":{"command":"restore","publishWebProjects":"true","projects":"ovpn3/core/impulse/OpenVPN/OpenVPN.sln","custom":"","arguments":"","publishTestResults":"true","zipAfterPublish":"true","modifyOutputPath":"true","selectOrConfig":"select","feedRestore":"","includeNuGetOrg":"true","nugetConfigPath":"","externalEndpoints":"","noCache":"false","packagesDirectory":"","verbosityRestore":"Detailed","searchPatternPush":"$(Build.ArtifactStagingDirectory)/*.nupkg","nuGetFeedType":"internal","feedPublish":"","publishPackageMetadata":"true","externalEndpoint":"","searchPatternPack":"**/*.csproj","configurationToPack":"$(BuildConfiguration)","outputDir":"$(Build.ArtifactStagingDirectory)","nobuild":"false","versioningScheme":"off","versionEnvVar":"","requestedMajorVersion":"1","requestedMinorVersion":"0","requestedPatchVersion":"0","buildProperties":"","verbosityPack":"Detailed","workingDirectory":""}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Build C# (.NET Classic)","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"c6c4c611-aa2e-4a33-b606-5eaba2196824","versionSpec":"1.*","definitionType":"task"},"inputs":{"solution":"ovpn3/core/impulse/OpenVPN/OpenVPN.sln","msbuildLocationMethod":"version","msbuildVersion":"15.0","msbuildArchitecture":"x64","msbuildLocation":"","platform":"Any CPU","configuration":"Release","msbuildArguments":"/t:OpenVPN:rebuild","clean":"false","maximumCpuCount":"false","restoreNugetPackages":"false","logProjectEvents":"false","createLogFile":"false","logFileVerbosity":"normal"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Build C# (.NET Standard)","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"c6c4c611-aa2e-4a33-b606-5eaba2196824","versionSpec":"1.*","definitionType":"task"},"inputs":{"solution":"ovpn3/core/impulse/OpenVPN/OpenVPN.sln","msbuildLocationMethod":"version","msbuildVersion":"15.0","msbuildArchitecture":"x64","msbuildLocation":"","platform":"Any CPU","configuration":"Release","msbuildArguments":"/t:OpenVPNDotNetStandard:rebuild","clean":"false","maximumCpuCount":"false","restoreNugetPackages":"false","logProjectEvents":"false","createLogFile":"false","logFileVerbosity":"normal"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Swig sources","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c","versionSpec":"2.*","definitionType":"task"},"inputs":{"SourceFolder":".swig","Contents":"**/*.cs","TargetFolder":"ovpn3/core/.build/sources","CleanTargetFolder":"false","OverWrite":"false","flattenFolders":"false"}},{"environment":{},"enabled":false,"continueOnError":false,"alwaysRun":false,"displayName":"Native DLL x86","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c","versionSpec":"2.*","definitionType":"task"},"inputs":{"SourceFolder":"ovpn3/core/win/bin/x86","Contents":"**/*.dll","TargetFolder":"ovpn3/core/.build/win/x86","CleanTargetFolder":"false","OverWrite":"false","flattenFolders":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Native DLL x64","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c","versionSpec":"2.*","definitionType":"task"},"inputs":{"SourceFolder":"ovpn3/core/win/bin/x64","Contents":"**/*.dll","TargetFolder":"ovpn3/core/.build/win/x64","CleanTargetFolder":"false","OverWrite":"false","flattenFolders":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"C# (.NET Classic)","timeoutInMinutes":0,"condition":"succeeded()","refName":"","task":{"id":"5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c","versionSpec":"2.*","definitionType":"task"},"inputs":{"SourceFolder":"ovpn3/core/impulse/OpenVPN/OpenVPN/bin/Release","Contents":"**/*.dll\n**/*.pdb","TargetFolder":"ovpn3/core/.build/csharp/classic","CleanTargetFolder":"false","OverWrite":"false","flattenFolders":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"C# (.NET Standard)","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c","versionSpec":"2.*","definitionType":"task"},"inputs":{"SourceFolder":"ovpn3/core/impulse/OpenVPN/OpenVPNDotNetStandard/bin/Release/netstandard2.0","Contents":"**/*.dll\n**/*.pdb","TargetFolder":"ovpn3/core/.build/csharp/standard","CleanTargetFolder":"false","OverWrite":"false","flattenFolders":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Publish Artifact: windows","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"2ff763a7-ce83-4e1f-bc89-0ae63477cebe","versionSpec":"1.*","definitionType":"task"},"inputs":{"PathtoPublish":"ovpn3/core/.build","ArtifactName":"windows","ArtifactType":"Container","TargetPath":"","Parallel":"false","ParallelCount":"8"}}],"name":"Windows","refName":"Phase_1","condition":"succeeded()","target":{"queue":{"_links":{"self":{"href":"https://impulse-point.visualstudio.com/_apis/build/Queues/4"}},"id":4,"url":"https://impulse-point.visualstudio.com/_apis/build/Queues/4","pool":null},"executionOptions":{"type":0},"allowScriptsAuthAccessOption":false,"type":1},"jobAuthorizationScope":1,"jobCancelTimeoutInMinutes":1},{"steps":[{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Download and execute swig","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"2.*","definitionType":"task"},"inputs":{"script":"/usr/bin/ruby -e \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\"\nbrew install pcre\n\nmkdir .swig_bin\npushd .swig_bin\n\ncurl http://downloads.impulse.com/vsts/mac/swig.tar.gz --output swig.tar.gz\ntar -xvf swig.tar.gz\n\npopd\n\nmkdir .swig\npushd .swig\n\nSWIG_LIB=$(pwd)/../.swig_bin/swig/Lib $(pwd)/../.swig_bin/swig/swig -monoaotcompat -c++ -csharp -I../ovpn3/core/client -I../ovpn3/core -outcurrentdir ../ovpn3/core/javacli/ovpncli.i\n\npopd","workingDirectory":"","failOnStderr":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Create directories and apply patch files","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"mkdir -p $SYSTEM_DEFAULTWORKINGDIRECTORY/dependencies\nmkdir -p $SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3-build\n\npatch $SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3/core/deps/lib-versions $SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3/core/impulse/lib-versions.patch\npatch $SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3/core/deps/asio/build-asio $SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3/core/impulse/build-asio.patch\npatch $SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3/core/deps/lz4/build-lz4 $SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3/core/impulse/build-lz4.patch\npatch $SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3/core/deps/mbedtls/build-mbedtls $SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3/core/impulse/build-mbedtls","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Build asio","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"export O3=$SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3\nexport DL=$SYSTEM_DEFAULTWORKINGDIRECTORY/dependencies\nexport DEP_DIR=$SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3-build\n\n$O3/core/deps/asio/build-asio","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Build lz4","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"export O3=$SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3\nexport DL=$SYSTEM_DEFAULTWORKINGDIRECTORY/dependencies\nexport DEP_DIR=$SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3-build\n\n$O3/core/scripts/mac/build-lz4","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Build mbedtls","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"export O3=$SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3\nexport DL=$SYSTEM_DEFAULTWORKINGDIRECTORY/dependencies\nexport DEP_DIR=$SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3-build\n\n$O3/core/scripts/mac/build-mbedtls","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Build native dylib (OS X)","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"export O3=$SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3\nexport DL=$SYSTEM_DEFAULTWORKINGDIRECTORY/dependencies\nexport DEP_DIR=$SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3-build\n\nexport SWIG_DIR=$SYSTEM_DEFAULTWORKINGDIRECTORY/.swig\n\n. vars/vars-osx64\n. vars/setpath\n\n# DEP_DIR is one of the OpenVPN variables, and the prior scripts will have mangled it\nexport DEP_DIR=$SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3-build\n\ncd $O3/core/client\n\nmkdir -p mac\n\nECHO=1 MTLS=1 LZ4=1 ASIO=1 ASIO_DIR=$DEP_DIR/asio OUTBIN=mac/libovpncli.dylib EXTRA_CPP=\"-dynamiclib $SWIG_DIR/ovpncli_wrap.cxx -I$SWIG_DIR -I$O3/core/client -DUSE_TUN_BUILDER\" build ovpncli","workingDirectory":"ovpn3/core","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Build native dylib (iOS)","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"export O3=$SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3\nexport DL=$SYSTEM_DEFAULTWORKINGDIRECTORY/dependencies\nexport DEP_DIR=$SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3-build\n\nexport SWIG_DIR=$SYSTEM_DEFAULTWORKINGDIRECTORY/.swig\n\n. vars/vars-ios\n. vars/setpath\n\n# DEP_DIR is one of the OpenVPN variables, and the prior scripts will have mangled it\nexport DEP_DIR=$SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3-build\n\n# have to fix variables set by OpenVPN scripts\nPLATFORM_FLAGS=$(echo $PLATFORM_FLAGS | sed -E 's/-miphoneos-version-min=[0-9\\.]+/-miphoneos-version-min=9.0/')\n# CXX_COMPILER_FLAGS=\"$CXX_COMPILER_FLAGS -x objective-c++ -lobjc\"\n\ncd $O3/core/client\n\nsed 's/-framework ApplicationServices/-framework UIKit/' ../scripts/build > ../scripts/build.ios\nchmod +x ../scripts/build.ios\n\nmkdir -p ios\n\ncp ovpncli.cpp ovpncli.mm\n\n# MTLS, ios only\nECHO=1 OBJC=1 MTLS=1 LZ4=1 ASIO=1 ASIO_DIR=$DEP_DIR/asio OUTBIN=ios/libovpncli.dylib EXTRA_CPP=\"-dynamiclib $SWIG_DIR/ovpncli_wrap.cxx -I$SWIG_DIR -I$O3/core/client\" build.ios ovpncli\n\n# MTLS, ios extension so we can do simulator only\n# ECHO=1 OBJC=1 MTLS=1 LZ4=1 ASIO=1 ASIO_DIR=$DEP_DIR/asio OUTBIN=ios/libovpncli.dylib.ios EXTRA_CPP=\"-dynamiclib $SWIG_DIR/ovpncli_wrap.cxx -I$SWIG_DIR -I$O3/core/client\" build.ios ovpncli\n","workingDirectory":"ovpn3/core","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":false,"continueOnError":false,"alwaysRun":false,"displayName":"Build native dylib (iOS Simulator)","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"export O3=$SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3\nexport DL=$SYSTEM_DEFAULTWORKINGDIRECTORY/dependencies\nexport DEP_DIR=$SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3-build\n\nexport SWIG_DIR=$SYSTEM_DEFAULTWORKINGDIRECTORY/.swig\n\n. vars/vars-iossim\n. vars/setpath\n\n# DEP_DIR is one of the OpenVPN variables, and the prior scripts will have mangled it\nexport DEP_DIR=$SYSTEM_DEFAULTWORKINGDIRECTORY/ovpn3-build\n\n# have to fix variables set by OpenVPN scripts\nPLATFORM_FLAGS=$(echo $PLATFORM_FLAGS | sed -E 's/-miphoneos-version-min=[0-9\\.]+/-miphoneos-version-min=9.0/')\nCXX_COMPILER_FLAGS=\"$CXX_COMPILER_FLAGS -x objective-c++ -lobjc\"\n\ncd $O3/core/client\n\nsed 's/-framework ApplicationServices/-framework UIKit/' ../scripts/build > ../scripts/build.iossim\nchmod +x ../scripts/build.iossim\n\nmkdir -p ios\nMTLS=1 ASIO=1 ASIO_DIR=$DEP_DIR/asio OUTBIN=ios/libovpncli.dylib.iossim EXTRA_CPP=\"-dynamiclib $SWIG_DIR/ovpncli_wrap.cxx -I$SWIG_DIR -I$O3/core/client -DUSE_ASIO_THREADLOCAL\" build.iossim ovpncli","workingDirectory":"ovpn3/core","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":false,"continueOnError":false,"alwaysRun":false,"displayName":"Combine iOS and iOS Simulator dylibs","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"lipo libovpncli.dylib.ios libovpncli.dylib.iossim -output libovpncli.dylib -create","workingDirectory":"ovpn3/core/client/ios","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"strip dylib","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"strip -u -r libovpncli.dylib","workingDirectory":"ovpn3/core/client/ios","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"dotnet restore","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"5541a522-603c-47ad-91fc-a4b1d163081b","versionSpec":"2.*","definitionType":"task"},"inputs":{"command":"restore","publishWebProjects":"true","projects":"ovpn3/core/impulse/OpenVPN/OpenVPN.sln","custom":"","arguments":"","publishTestResults":"true","zipAfterPublish":"true","modifyOutputPath":"true","selectOrConfig":"select","feedRestore":"","includeNuGetOrg":"true","nugetConfigPath":"","externalEndpoints":"","noCache":"false","packagesDirectory":"","verbosityRestore":"Detailed","searchPatternPush":"$(Build.ArtifactStagingDirectory)/*.nupkg","nuGetFeedType":"internal","feedPublish":"","publishPackageMetadata":"true","externalEndpoint":"","searchPatternPack":"**/*.csproj","configurationToPack":"$(BuildConfiguration)","outputDir":"$(Build.ArtifactStagingDirectory)","nobuild":"false","versioningScheme":"off","versionEnvVar":"","requestedMajorVersion":"1","requestedMinorVersion":"0","requestedPatchVersion":"0","buildProperties":"","verbosityPack":"Detailed","workingDirectory":""}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Build C# (.NET Standard)","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"c6c4c611-aa2e-4a33-b606-5eaba2196824","versionSpec":"1.*","definitionType":"task"},"inputs":{"solution":"ovpn3/core/impulse/OpenVPN/OpenVPN.sln","msbuildLocationMethod":"version","msbuildVersion":"15.0","msbuildArchitecture":"x64","msbuildLocation":"","platform":"Any CPU","configuration":"Release","msbuildArguments":"/t:OpenVPNDotNetStandard:rebuild","clean":"false","maximumCpuCount":"false","restoreNugetPackages":"false","logProjectEvents":"false","createLogFile":"false","logFileVerbosity":"normal"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Swig sources","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c","versionSpec":"2.*","definitionType":"task"},"inputs":{"SourceFolder":".swig","Contents":"**/*.cs","TargetFolder":"ovpn3/core/.build/sources","CleanTargetFolder":"false","OverWrite":"false","flattenFolders":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Native dylib (OS X)","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c","versionSpec":"2.*","definitionType":"task"},"inputs":{"SourceFolder":"ovpn3/core/client/mac","Contents":"libovpncli.dylib","TargetFolder":"ovpn3/core/.build/mac","CleanTargetFolder":"false","OverWrite":"false","flattenFolders":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Native dylib (iOS and iOS Simulator)","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c","versionSpec":"2.*","definitionType":"task"},"inputs":{"SourceFolder":"ovpn3/core/client/ios","Contents":"libovpncli.dylib","TargetFolder":"ovpn3/core/.build/ios","CleanTargetFolder":"false","OverWrite":"false","flattenFolders":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"C# (.NET Standard)","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c","versionSpec":"2.*","definitionType":"task"},"inputs":{"SourceFolder":"ovpn3/core/impulse/OpenVPN/OpenVPNDotNetStandard/bin/Release/netstandard2.0","Contents":"**/*.dll\n**/*.pdb","TargetFolder":"ovpn3/core/.build/csharp/standard_apple","CleanTargetFolder":"false","OverWrite":"false","flattenFolders":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Publish Artifact: mac","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"2ff763a7-ce83-4e1f-bc89-0ae63477cebe","versionSpec":"1.*","definitionType":"task"},"inputs":{"PathtoPublish":"ovpn3/core/.build","ArtifactName":"mac","ArtifactType":"Container","TargetPath":"","Parallel":"false","ParallelCount":"8"}}],"name":"Mac","refName":"Phase_2","condition":"succeeded()","target":{"queue":{"_links":{"self":{"href":"https://impulse-point.visualstudio.com/_apis/build/Queues/5"}},"id":5,"url":"https://impulse-point.visualstudio.com/_apis/build/Queues/5","pool":null},"executionOptions":{"type":0},"allowScriptsAuthAccessOption":false,"type":1},"jobAuthorizationScope":1,"jobCancelTimeoutInMinutes":1},{"steps":[{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Install dependencies","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"sudo apt update\nsudo apt install -y swig libasio-dev liblz4-dev libmbedtls-dev","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Generate swig sources","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"mkdir .swig\ncd .swig\nswig -c++ -csharp -I../ovpn3/core/client -I../ovpn3/core -outcurrentdir ../ovpn3/core/javacli/ovpncli.i","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"symlink android ndk so openvpn build scripts work","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"export SDK=/usr/local/lib/android/sdk\nexport NDK_TOOLCHAIN=$SDK/ndk-bundle/toolchains/llvm/prebuilt/linux-x86_64\n\nexport O3=$(pwd)/ovpn3\nexport DEP_DIR=$O3/../ovpn3-build\n\nmkdir -p $DEP_DIR/{tc-arm,tc-arm64,tc-x86}/bin\n\nln -s $NDK_TOOLCHAIN/bin/armv7a-linux-androideabi21-clang++ $DEP_DIR/tc-arm/bin/arm-linux-androideabi-g++\nln -s $NDK_TOOLCHAIN/bin/armv7a-linux-androideabi21-clang $DEP_DIR/tc-arm/bin/arm-linux-androideabi-gcc\nln -s $NDK_TOOLCHAIN/bin/clang++ $DEP_DIR/tc-arm/bin/clang++\nln -s $NDK_TOOLCHAIN/bin/clang $DEP_DIR/tc-arm/bin/clang\nln -s $NDK_TOOLCHAIN/bin/arm-linux-androideabi-ld $DEP_DIR/tc-arm/bin/\nln -s $NDK_TOOLCHAIN/bin/arm-linux-androideabi-ld $DEP_DIR/tc-arm/bin/ld\nln -s $NDK_TOOLCHAIN/sysroot $DEP_DIR/tc-arm/\n\nln -s $NDK_TOOLCHAIN/bin/aarch64-linux-android21-clang++ $DEP_DIR/tc-arm64/bin/aarch64-linux-android-g++\nln -s $NDK_TOOLCHAIN/bin/aarch64-linux-android21-clang $DEP_DIR/tc-arm64/bin/aarch64-linux-android-gcc\nln -s $NDK_TOOLCHAIN/bin/clang++ $DEP_DIR/tc-arm64/bin/clang++\nln -s $NDK_TOOLCHAIN/bin/clang $DEP_DIR/tc-arm64/bin/clang\nln -s $NDK_TOOLCHAIN/bin/aarch64-linux-android-ld $DEP_DIR/tc-arm64/bin/\nln -s $NDK_TOOLCHAIN/bin/aarch64-linux-android-ld $DEP_DIR/tc-arm64/bin/ld\nln -s $NDK_TOOLCHAIN/sysroot $DEP_DIR/tc-arm64/\n\nln -s $NDK_TOOLCHAIN/bin/i686-linux-android21-clang++ $DEP_DIR/tc-x86/bin/i686-linux-android-g++\nln -s $NDK_TOOLCHAIN/bin/i686-linux-android21-clang $DEP_DIR/tc-x86/bin/i686-linux-android-gcc\nln -s $NDK_TOOLCHAIN/bin/clang++ $DEP_DIR/tc-x86/bin/clang++\nln -s $NDK_TOOLCHAIN/bin/clang $DEP_DIR/tc-x86/bin/clang\nln -s $NDK_TOOLCHAIN/bin/i686-linux-android-ld $DEP_DIR/tc-x86/bin/\nln -s $NDK_TOOLCHAIN/bin/i686-linux-android-ld $DEP_DIR/tc-x86/bin/ld\nln -s $NDK_TOOLCHAIN/sysroot $DEP_DIR/tc-x86/","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"correct build scripts for android","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"export O3=$(pwd)/ovpn3\n\n# version should match what version of the compiler we use\nsed -i -E 's/__ANDROID_API__=[0-9]+/__ANDROID_API__=21/' $O3/core/vars/vars-android-a8a\nsed -i -E 's/__ANDROID_API__=[0-9]+/__ANDROID_API__=21/' $O3/core/vars/vars-android-a7a\nsed -i -E 's/__ANDROID_API__=[0-9]+/__ANDROID_API__=21/' $O3/core/vars/vars-android-x86","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Build mbedtls","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"CFLAGS=\"-fPIC\" make","workingDirectory":"dependencies/mbedtls-master","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Build lz4","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"CFLAGS=\"-fPIC\" make\nmkdir -p ../lz4/lz4-linux/lib\ncp lib/liblz4.a ../lz4/lz4-linux/lib/","workingDirectory":"dependencies/lz4-master","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Build native so","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"export O3=$(pwd)/ovpn3\nexport SWIG_DIR=$(pwd)/.swig\nexport DEP_DIR=$O3/../dependencies\n\npushd $O3/core/test/ovpncli\nECHO=1 PROF=linux ASIO_DIR=$O3/../dependencies/asio-master MTLS=1 MTLS_PATH=$O3/../dependencies/mbedtls-master LZ4=1 NOSSL=1 OUTBIN=libovpncli.so EXTRA_CPP=\"-shared -fPIC $SWIG_DIR/ovpncli_wrap.cxx -I$SWIG_DIR -I$O3/core/client -lmbedcrypto -lmbedx509\" $O3/core/scripts/build cli\npopd\n\nmkdir -p .build/linux\ncp $O3/core/test/ovpncli/libovpncli.so .build/linux","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Build asio android","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"export SDK=/usr/local/lib/android/sdk\nexport NDK_TOOLCHAIN=$SDK/ndk-bundle/toolchains/llvm/prebuilt/linux-x86_64\n\nexport O3=$(pwd)/ovpn3\nexport DL=$(pwd)/dependencies\nexport DEP_DIR=$(pwd)/ovpn3-build\n\n$O3/core/deps/asio/build-asio\n\n# header only library, now that we've copied stuff into the right location we can edit a header\n# android sdk is new enough that it's no longer an experimental feature\nsed -i 's/std::experimental::string_view/std::string_view/' $DEP_DIR/asio/asio/include/asio/detail/string_view.hpp","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Build lz4 android","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"export SDK=/usr/local/lib/android/sdk\nexport NDK_TOOLCHAIN=$SDK/ndk-bundle/toolchains/llvm/prebuilt/linux-x86_64\n\nexport O3=$(pwd)/ovpn3\nexport DL=$(pwd)/dependencies\nexport DEP_DIR=$(pwd)/ovpn3-build\n\n$O3/core/scripts/android/build-lz4","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Build mbedtls android","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"export SDK=/usr/local/lib/android/sdk\nexport NDK_TOOLCHAIN=$SDK/ndk-bundle/toolchains/llvm/prebuilt/linux-x86_64\n\nexport O3=$(pwd)/ovpn3\nexport DL=$(pwd)/dependencies\nexport DEP_DIR=$(pwd)/ovpn3-build\n\n$O3/core/scripts/android/build-mbedtls","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Build native android-a8a","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"export SDK=/usr/local/lib/android/sdk\nexport NDK_TOOLCHAIN=$SDK/ndk-bundle/toolchains/llvm/prebuilt/linux-x86_64\n\nexport O3=$(pwd)/ovpn3\nexport DL=$(pwd)/dependencies\nexport DEP_DIR=$(pwd)/ovpn3-build\nexport SWIG_DIR=$(pwd)/.swig\n\ncd $O3/core/client\n\n. ../vars/vars-android-a8a\n. ../vars/setpath\nOUTDIR=android/android-a8a\nmkdir -p $OUTDIR\nECHO=1 MTLS=1 LZ4=1 ASIO=1 ASIO_DIR=$DEP_DIR/asio NOSSL=1 OUTBIN=$OUTDIR/libovpncli.so EXTRA_CPP=\"$SWIG_DIR/ovpncli_wrap.cxx -I$SWIG_DIR -I$O3/core/client -DUSE_TUN_BUILDER -DASIO_HAS_STD_STRING_VIEW -DLZ4_DISABLE_DEPRECATE_WARNINGS -L$NDK_TOOLCHAIN/lib/gcc/aarch64-linux-android/4.9.x -shared -fPIC\" build ovpncli\n\n# also need libc++\ncp $NDK_TOOLCHAIN/sysroot/usr/lib/aarch64-linux-android/libc++_shared.so $OUTDIR/\n","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Build native android-a7a","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"export SDK=/usr/local/lib/android/sdk\nexport NDK_TOOLCHAIN=$SDK/ndk-bundle/toolchains/llvm/prebuilt/linux-x86_64\n\nexport O3=$(pwd)/ovpn3\nexport DL=$(pwd)/dependencies\nexport DEP_DIR=$(pwd)/ovpn3-build\nexport SWIG_DIR=$(pwd)/.swig\n\ncd $O3/core/client\n\n. ../vars/vars-android-a7a\n. ../vars/setpath\nOUTDIR=android/android-a7a\nmkdir -p $OUTDIR\nECHO=1 MTLS=1 LZ4=1 ASIO=1 ASIO_DIR=$DEP_DIR/asio NOSSL=1 OUTBIN=$OUTDIR/libovpncli.so EXTRA_CPP=\"$SWIG_DIR/ovpncli_wrap.cxx -I$SWIG_DIR -I$O3/core/client -DUSE_TUN_BUILDER -DASIO_HAS_STD_STRING_VIEW -DLZ4_DISABLE_DEPRECATE_WARNINGS -L$NDK_TOOLCHAIN/lib/gcc/arm-linux-androideabi/4.9.x -shared -fPIC\" build ovpncli\n\n# also need libc++\ncp $NDK_TOOLCHAIN/sysroot/usr/lib/arm-linux-androideabi/libc++_shared.so $OUTDIR/","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Build native android-x86","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"export SDK=/usr/local/lib/android/sdk\nexport NDK_TOOLCHAIN=$SDK/ndk-bundle/toolchains/llvm/prebuilt/linux-x86_64\n\nexport O3=$(pwd)/ovpn3\nexport DL=$(pwd)/dependencies\nexport DEP_DIR=$(pwd)/ovpn3-build\nexport SWIG_DIR=$(pwd)/.swig\n\ncd $O3/core/client\n\n. ../vars/vars-android-x86\n. ../vars/setpath\nOUTDIR=android/android-x86\nmkdir -p $OUTDIR\nECHO=1 MTLS=1 LZ4=1 ASIO=1 ASIO_DIR=$DEP_DIR/asio NOSSL=1 OUTBIN=$OUTDIR/libovpncli.so EXTRA_CPP=\"$SWIG_DIR/ovpncli_wrap.cxx -I$SWIG_DIR -I$O3/core/client -DUSE_TUN_BUILDER -DASIO_HAS_STD_STRING_VIEW -DLZ4_DISABLE_DEPRECATE_WARNINGS -L$NDK_TOOLCHAIN/lib/gcc/i686-linux-android/4.9.x -shared -fPIC\" build ovpncli\n\n# also need libc++\ncp $NDK_TOOLCHAIN/sysroot/usr/lib/i686-linux-android/libc++_shared.so $OUTDIR/","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Publish Artifact: linux","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"2ff763a7-ce83-4e1f-bc89-0ae63477cebe","versionSpec":"1.*","definitionType":"task"},"inputs":{"PathtoPublish":".build","ArtifactName":"linux","ArtifactType":"Container","TargetPath":"","Parallel":"false","ParallelCount":"8"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Publish Artifact: android","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"2ff763a7-ce83-4e1f-bc89-0ae63477cebe","versionSpec":"1.*","definitionType":"task"},"inputs":{"PathtoPublish":"ovpn3/core/client/android","ArtifactName":"android","ArtifactType":"Container","TargetPath":"","Parallel":"false","ParallelCount":"8"}}],"name":"Linux","refName":"Phase_4","condition":"succeeded()","target":{"queue":{"_links":{"self":{"href":"https://impulse-point.visualstudio.com/_apis/build/Queues/7"}},"id":7,"url":"https://impulse-point.visualstudio.com/_apis/build/Queues/7","pool":null},"executionOptions":{"type":0},"allowScriptsAuthAccessOption":false,"type":1},"jobAuthorizationScope":1,"jobCancelTimeoutInMinutes":1},{"dependencies":[{"scope":"Phase_1","event":"Completed"},{"scope":"Phase_2","event":"Completed"},{"scope":"Phase_4","event":"Completed"}],"steps":[{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"windows","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"a433f589-fce1-4460-9ee6-44a624aeb1fb","versionSpec":"0.*","definitionType":"task"},"inputs":{"buildType":"current","project":"","definition":"","specificBuildWithTriggering":"false","buildVersionToDownload":"latest","allowPartiallySucceededBuilds":"false","branchName":"refs/heads/master","buildId":"","tags":"","downloadType":"single","artifactName":"windows","itemPattern":"**","downloadPath":".build/artifacts","parallelizationLimit":"8"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"mac","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"a433f589-fce1-4460-9ee6-44a624aeb1fb","versionSpec":"0.*","definitionType":"task"},"inputs":{"buildType":"current","project":"","definition":"","specificBuildWithTriggering":"false","buildVersionToDownload":"latest","allowPartiallySucceededBuilds":"false","branchName":"refs/heads/master","buildId":"","tags":"","downloadType":"single","artifactName":"mac","itemPattern":"**","downloadPath":".build/artifacts","parallelizationLimit":"8"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"linux","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"a433f589-fce1-4460-9ee6-44a624aeb1fb","versionSpec":"0.*","definitionType":"task"},"inputs":{"buildType":"current","project":"","definition":"","specificBuildWithTriggering":"false","buildVersionToDownload":"latest","allowPartiallySucceededBuilds":"false","branchName":"refs/heads/master","buildId":"","tags":"","downloadType":"single","artifactName":"linux","itemPattern":"**","downloadPath":".build/artifacts","parallelizationLimit":"8"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"android","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"a433f589-fce1-4460-9ee6-44a624aeb1fb","versionSpec":"0.*","definitionType":"task"},"inputs":{"buildType":"current","project":"","definition":"","specificBuildWithTriggering":"false","buildVersionToDownload":"latest","allowPartiallySucceededBuilds":"false","branchName":"refs/heads/master","buildId":"","tags":"","downloadType":"single","artifactName":"android","itemPattern":"**","downloadPath":".build/artifacts","parallelizationLimit":"8"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"TESTING - output all artifact downloads","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","versionSpec":"3.*","definitionType":"task"},"inputs":{"targetType":"inline","filePath":"","arguments":"","script":"find .build/artifacts","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Copy Files to: ovpn3/core/.build/sources","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c","versionSpec":"2.*","definitionType":"task"},"inputs":{"SourceFolder":".build/artifacts/windows/sources","Contents":"**","TargetFolder":"ovpn3/core/.build/sources","CleanTargetFolder":"false","OverWrite":"false","flattenFolders":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Copy Files to: ovpn3/core/.build/win","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c","versionSpec":"2.*","definitionType":"task"},"inputs":{"SourceFolder":".build/artifacts/windows/win","Contents":"**","TargetFolder":"ovpn3/core/.build/win","CleanTargetFolder":"false","OverWrite":"false","flattenFolders":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Copy Files to: ovpn3/core/.build/csharp/classic","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c","versionSpec":"2.*","definitionType":"task"},"inputs":{"SourceFolder":".build/artifacts/windows/csharp/classic","Contents":"**","TargetFolder":"ovpn3/core/.build/csharp/classic","CleanTargetFolder":"false","OverWrite":"false","flattenFolders":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Copy Files to: ovpn3/core/.build/csharp/standard","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c","versionSpec":"2.*","definitionType":"task"},"inputs":{"SourceFolder":".build/artifacts/windows/csharp/standard","Contents":"**","TargetFolder":"ovpn3/core/.build/csharp/standard","CleanTargetFolder":"false","OverWrite":"false","flattenFolders":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Copy Files to: ovpn3/core/.build/mac","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c","versionSpec":"2.*","definitionType":"task"},"inputs":{"SourceFolder":".build/artifacts/mac/mac","Contents":"**/*.dylib","TargetFolder":"ovpn3/core/.build/mac","CleanTargetFolder":"false","OverWrite":"false","flattenFolders":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Copy Files to: ovpn3/core/.build/ios","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c","versionSpec":"2.*","definitionType":"task"},"inputs":{"SourceFolder":".build/artifacts/mac/ios","Contents":"**/*.dylib","TargetFolder":"ovpn3/core/.build/ios","CleanTargetFolder":"false","OverWrite":"false","flattenFolders":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Copy Files to: ovpn3/core/.build/csharp/standard_apple","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c","versionSpec":"2.*","definitionType":"task"},"inputs":{"SourceFolder":".build/artifacts/mac/csharp/standard_apple","Contents":"**","TargetFolder":"ovpn3/core/.build/csharp/standard_apple","CleanTargetFolder":"false","OverWrite":"false","flattenFolders":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Copy Files to: ovpn3/core/.build/linux","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c","versionSpec":"2.*","definitionType":"task"},"inputs":{"SourceFolder":".build/artifacts/linux/linux","Contents":"**","TargetFolder":"ovpn3/core/.build/linux","CleanTargetFolder":"false","OverWrite":"false","flattenFolders":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Copy Files to: ovpn3/core/.build/android","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c","versionSpec":"2.*","definitionType":"task"},"inputs":{"SourceFolder":".build/artifacts/android","Contents":"**","TargetFolder":"ovpn3/core/.build/android","CleanTargetFolder":"false","OverWrite":"false","flattenFolders":"false"}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"NuGet pack","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"333b11bd-d341-40d9-afcf-b32d5ce6f23b","versionSpec":"2.*","definitionType":"task"},"inputs":{"command":"pack","solution":"**/*.sln","selectOrConfig":"select","feedRestore":"","includeNuGetOrg":"true","nugetConfigPath":"","externalEndpoints":"","noCache":"false","disableParallelProcessing":"false","packagesDirectory":"","verbosityRestore":"Detailed","searchPatternPush":"$(Build.ArtifactStagingDirectory)/**/*.nupkg;!$(Build.ArtifactStagingDirectory)/**/*.symbols.nupkg","nuGetFeedType":"internal","feedPublish":"","publishPackageMetadata":"true","allowPackageConflicts":"false","externalEndpoint":"","verbosityPush":"Detailed","searchPatternPack":"ovpn3/core/impulse/OpenVPN.nuspec","configurationToPack":"$(BuildConfiguration)","outputDir":"$(Build.ArtifactStagingDirectory)","versioningScheme":"byPrereleaseNumber","includeReferencedProjects":"false","versionEnvVar":"","requestedMajorVersion":"1","requestedMinorVersion":"0","requestedPatchVersion":"0","packTimezone":"utc","includeSymbols":"false","toolPackage":"false","buildProperties":"","basePath":"","verbosityPack":"Detailed","arguments":""}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"NuGet push","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"333b11bd-d341-40d9-afcf-b32d5ce6f23b","versionSpec":"2.*","definitionType":"task"},"inputs":{"command":"push","solution":"**/*.sln","selectOrConfig":"select","feedRestore":"","includeNuGetOrg":"true","nugetConfigPath":"","externalEndpoints":"","noCache":"false","disableParallelProcessing":"false","packagesDirectory":"","verbosityRestore":"Detailed","searchPatternPush":"$(Build.ArtifactStagingDirectory)/**/*.nupkg;!$(Build.ArtifactStagingDirectory)/**/*.symbols.nupkg","nuGetFeedType":"external","feedPublish":"","publishPackageMetadata":"true","allowPackageConflicts":"false","externalEndpoint":"b7861166-36fe-4f04-a54a-adfcb3a9b12d","verbosityPush":"Detailed","searchPatternPack":"**/*.csproj","configurationToPack":"$(BuildConfiguration)","outputDir":"$(Build.ArtifactStagingDirectory)","versioningScheme":"off","includeReferencedProjects":"false","versionEnvVar":"","requestedMajorVersion":"1","requestedMinorVersion":"0","requestedPatchVersion":"0","packTimezone":"utc","includeSymbols":"false","toolPackage":"false","buildProperties":"","basePath":"","verbosityPack":"Detailed","arguments":""}}],"name":"NuGet","refName":"Phase_3","condition":"succeeded()","target":{"queue":{"_links":{"self":{"href":"https://impulse-point.visualstudio.com/_apis/build/Queues/4"}},"id":4,"url":"https://impulse-point.visualstudio.com/_apis/build/Queues/4","pool":null},"executionOptions":{"type":0},"allowScriptsAuthAccessOption":false,"type":1},"jobAuthorizationScope":1,"jobCancelTimeoutInMinutes":1}],"type":1},"repository":{"properties":{"fullName":"repository","cloneUrl":"https://github.com/impulse-point/openvpn-with-dependencies.git","isPrivate":"False","checkoutNestedSubmodules":"true","cleanOptions":"0","fetchDepth":"0","gitLfsSupport":"false","reportBuildStatus":"true","connectedServiceId":"52a67153-bd3c-4761-a91d-9a5868043286","skipSyncSource":"false","labelSourcesFormat":"$(build.buildNumber)","labelSources":"0"},"id":"https://github.com/impulse-point/openvpn-with-dependencies.git","type":"Git","name":"repository","url":"https://github.com/impulse-point/openvpn-with-dependencies.git","defaultBranch":"master","clean":"false","checkoutSubmodules":true},"processParameters":{},"quality":1,"authoredBy":{"displayName":"Jeffrey Price","url":"https://app.vssps.visualstudio.com/A356b6f6d-6188-4aaf-ab11-0c09c3d6a4db/_apis/Identities/e4a6e6ac-b4a2-6303-a849-f996d98036e6","_links":{"avatar":{"href":"https://impulse-point.visualstudio.com/_apis/GraphProfile/MemberAvatars/msa.ZTRhNmU2YWMtYjRhMi03MzAzLWE4NDktZjk5NmQ5ODAzNmU2"}},"id":"e4a6e6ac-b4a2-6303-a849-f996d98036e6","uniqueName":"jprice@impulse.com","imageUrl":"https://impulse-point.visualstudio.com/_api/_common/identityImage?id=e4a6e6ac-b4a2-6303-a849-f996d98036e6","descriptor":"msa.ZTRhNmU2YWMtYjRhMi03MzAzLWE4NDktZjk5NmQ5ODAzNmU2"},"drafts":[],"queue":{"_links":{"self":{"href":"https://impulse-point.visualstudio.com/_apis/build/Queues/2"}},"id":2,"name":"Hosted","url":"https://impulse-point.visualstudio.com/_apis/build/Queues/2","pool":{"id":2,"name":"Hosted","isHosted":true}},"id":11,"name":"OpenVPN","url":"https://impulse-point.visualstudio.com/6e18cf95-575d-4867-9f79-45c08f8a903a/_apis/build/Definitions/11?revision=72","uri":"vstfs:///Build/Definition/11","path":"\\","type":2,"queueStatus":0,"revision":72,"createdDate":"2019-03-22T17:12:55.493Z","project":{"id":"6e18cf95-575d-4867-9f79-45c08f8a903a","name":"SDP","url":"https://impulse-point.visualstudio.com/_apis/projects/6e18cf95-575d-4867-9f79-45c08f8a903a","state":1,"revision":9,"visibility":0,"lastUpdateTime":"2018-03-01T12:38:42.207Z"}}